var maintext,theValue,counter,copy,speech,voices,fontsize,lineheight,colorlight,colordark,backgroundlight,backgrounddark,backgroundcolor,backgroundimage,backgroundsource,backgroundsize,printicon,password,enterpassword;function save(){theValue=maintext.value,chrome.storage.sync.set({txtvalue:theValue})}var i18nfirsttext=chrome.i18n.getMessage("firsttext"),i18ndefault=chrome.i18n.getMessage("titeldefault"),i18npasswordplaceholder=chrome.i18n.getMessage("passwordplaceholder"),i18ntitelcopytext=chrome.i18n.getMessage("titlecopytextdone"),i18ndescopytext=chrome.i18n.getMessage("descopytextdone");function focuspassword(){document.getElementById("inputpass").focus()}function init(){maintext=document.querySelector("#maintext"),chrome.storage.sync.get(["firstDate","optionskipremember","txtvalue","counter","copy","speech","voices","fontsize","lineheight","colorlight","colordark","backgroundlight","backgrounddark","backgroundcolor","backgroundimage","backgroundsource","backgroundsize","print","password","enterpassword"],(function(e){if(null==(theValue=e.txtvalue)&&(theValue=i18nfirsttext),null==(counter=e.counter)&&(counter=!0),null==(copy=e.copy)&&(copy=!0),null==(speech=e.speech)&&(speech=!0),null==(voices=e.voices)&&(voices=!1),null==(fontsize=e.fontsize)&&(fontsize=18),null==(lineheight=e.lineheight)&&(lineheight=26),null==(colorlight=e.colorlight)&&(colorlight="#373737"),null==(colordark=e.colordark)&&(colordark="#ffffff"),null==(backgroundlight=e.backgroundlight)&&(backgroundlight="#ffffff"),null==(backgrounddark=e.backgrounddark)&&(backgrounddark="#232323"),null==(backgroundcolor=e.backgroundcolor)&&(backgroundcolor=!0),null==(backgroundimage=e.backgroundimage)&&(backgroundimage=!1),null==(backgroundsource=e.backgroundsource)&&(backgroundsource=0),null==(backgroundsize=e.backgroundsize)&&(backgroundsize=150),null==(printicon=e.print)&&(printicon=!1),password=e.password,null==printicon&&(printicon=!1),null==(enterpassword=e.enterpassword)&&(enterpassword=""),1==password){var t=document.createElement("div");t.id="lockscreen",t.addEventListener("contextmenu",(e=>e.preventDefault())),document.body.appendChild(t);var n=document.createElement("input");n.type="password",n.id="inputpass",n.setAttribute("autofocus","autofocus"),n.placeholder=i18npasswordplaceholder,n.addEventListener("mousemove",(function(){focuspassword()})),n.addEventListener("input",(function(){checkpassword(this.value)})),n.addEventListener("keypress",(function(e){"Enter"===e.key&&(checkpassword(this.value),this.value!=enterpassword&&(n.classList.add("animation"),window.setTimeout((()=>{n.classList.contains("animation")&&n.classList.remove("animation")}),1e3)))})),t.appendChild(n),focuspassword()}var o=!1,c=(new Date).getTime();e.firstDate?o=!(c>=e.firstDate+2592e6):(chrome.storage.sync.set({firstDate:c}),o=!0),o?document.getElementById("exabeampromo").className="hidden":1!=e.optionskipremember?document.getElementById("exabeampromo").className="":document.getElementById("exabeampromo").className="hidden",theValue||(theValue=""),maintext.value=theValue,1==counter?(countcharacters(),document.getElementById("boxcharacter").className=""):document.getElementById("boxcharacter").className="hidden",document.getElementById("copytext").className=1==copy?"btn-copy":"hidden",document.getElementById("texttospeech").className=1==speech?"":"hidden",document.getElementById("field").className=1==voices?"":"hidden",document.getElementById("printtext").className=1==printicon?"btn-print":"hidden",1==backgroundimage&&addbackgroundpaper(),addstylecode()})),maintext.onchange=function(){save()},maintext.oninput=function(){countcharacters()},document.querySelector(".close").addEventListener("click",(()=>{document.getElementById("exabeampromo").className="hidden"}))}function checkpassword(e){if(e==enterpassword){var t=document.getElementById("lockscreen");t&&t.parentNode.removeChild(t)}}function addstylecode(){const e=document.createElement("style");e.id="notestyle",e.textContent="\n\t/* Light mode */\n\t:root {\n\t\t--ext-primary-background:"+backgroundlight+";\n\t\t--ext-primary-font-color:#000;\n\t\t--ext-nav-color:"+colorlight+";\n\t\t--ext-font-size:"+fontsize+"px;\n\t\t--ext-line-height:"+lineheight+"px;\n\t\t--ext-lock-boxshadow: 0 1px 6px 0 rgba(32, 33, 36, .28);\n\t\t--ext-lock-hover:#fbfbfb;\n\t}\n\t\n\t/* Dark mode */\n\t@media (prefers-color-scheme: dark) {\n\t\t:root{\n\t\t--ext-primary-background:"+backgrounddark+";\n\t\t--ext-primary-font-color:#fff;\n\t\t--ext-nav-color:"+colordark+";\n\t\t--ext-font-size:"+fontsize+"px;\n\t\t--ext-line-height:"+lineheight+"px;\n\t\t--ext-lock-boxshadow: 0 1px 6px 0 rgba(255, 255, 255, 0.28);\n\t\t--ext-lock-hover:#282828;\n\t\t}\n\t}\n\t",document.head.appendChild(e)}function removestylecode(){var e=document.getElementById("notestyle");e&&e.parentNode.removeChild(e)}function addbackgroundpaper(){const e=document.createElement("div");e.id="bcknotepaper",e.className="notepaper",e.style.backgroundSize=backgroundsize+"px "+backgroundsize+"px",document.body.appendChild(e),updatebackgroundpaper()}function removebackgroundpaper(){var e=document.getElementById("bcknotepaper");e&&e.parentNode.removeChild(e)}function updatebackgroundpaper(){var e=document.getElementById("bcknotepaper");e&&(0==backgroundsource?e.style.backgroundImage="url("+chrome.runtime.getURL("images/blue-grid.png")+")":1==backgroundsource?e.style.backgroundImage="url("+chrome.runtime.getURL("images/black-grid.png")+")":2==backgroundsource?e.style.backgroundImage="url("+chrome.runtime.getURL("images/blue-lines.png")+")":3==backgroundsource&&(e.style.backgroundImage="url("+chrome.runtime.getURL("images/black-lines.png")+")"))}function countcharacters(){document.getElementById("counter").textContent=document.querySelector("#maintext").value.length}window.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("maintext"),t=document.getElementsByTagName("main")[0],n=document.getElementById("voices");let o,c;const a=()=>{const e=speechSynthesis.getVoices();n.innerHTML="",e.forEach((e=>{const t=document.createElement("option");let o=`${e.name} (${e.lang})`;e.default&&(o+=" ["+i18ndefault+"]",void 0===c&&(c=e,t.selected=!0)),c===e&&(t.selected=!0),t.textContent=o,n.appendChild(t)})),o=e};var d;a(),void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=a),n.addEventListener("change",(e=>{const t=e.target.selectedIndex;c=o[t]})),document.getElementById("startspeech").addEventListener("click",(n=>{n.preventDefault();const o=e.value.trim();(d=new SpeechSynthesisUtterance(o)).voice=c,d.rate=.85,d.addEventListener("start",(()=>{t.classList.add("speaking"),document.getElementById("startspeech").classList.add("hidden"),document.getElementById("stopspeech").classList.remove("hidden")})),d.addEventListener("end",(()=>{t.classList.remove("speaking"),document.getElementById("startspeech").classList.remove("hidden"),document.getElementById("stopspeech").classList.add("hidden")})),speechSynthesis.speak(d)})),document.getElementById("stopspeech").addEventListener("click",(e=>{e.preventDefault(),speechSynthesis.cancel(),document.getElementById("startspeech").classList.remove("hidden"),document.getElementById("stopspeech").classList.add("hidden")})),document.getElementById("copytext").addEventListener("click",(()=>{document.getElementById("maintext").select(),document.execCommand("copy"),0==showingcopybadge&&showcopytextbadge()})),document.getElementById("addtoincident").addEventListener("click",(()=>{confirm("This will be the text to be added to the incident: "+e.value.trim())?txt="You pressed OK!":txt="You pressed Cancel!"})),document.getElementById("printtext").addEventListener("click",(()=>{print()}))}));var showingcopybadge=!1;function showcopytextbadge(){var e=document.createElement("div");e.setAttribute("id","exabeamremoteadd"),e.className="exabeamremote",document.body.appendChild(e);var t=document.createElement("h3");t.innerText=i18ntitelcopytext,e.appendChild(t);var n=document.createElement("p");n.innerText=i18ndescopytext,e.appendChild(n),showingcopybadge=!0,window.setTimeout((function(){var e=document.getElementById("exabeamremoteadd");e.parentNode.removeChild(e),showingcopybadge=!1}),4e3)}document.addEventListener("DOMContentLoaded",init,!1),chrome.runtime.onMessage.addListener((function(e){if("setnotetext"==e.msg)document.querySelector("#maintext").value=e.value;else if("setcounter"==e.msg)1==e.value?(countcharacters(),document.getElementById("boxcharacter").className=""):document.getElementById("boxcharacter").className="hidden";else if("setcopy"==e.msg)1==e.value?document.getElementById("copytext").className="btn-copy":document.getElementById("copytext").className="hidden";else if("setspeech"==e.msg)1==e.value?document.getElementById("texttospeech").className="":document.getElementById("texttospeech").className="hidden";else if("setvoices"==e.msg)1==e.value?document.getElementById("field").className="":document.getElementById("field").className="hidden";else if("setfontsize"==e.msg)fontsize=e.value,removestylecode(),addstylecode();else if("setcolorlight"==e.msg)colorlight=e.value,removestylecode(),addstylecode();else if("setcolordark"==e.msg)colordark=e.value,removestylecode(),addstylecode();else if("setbackgroundlight"==e.msg)backgroundlight=e.value,removestylecode(),addstylecode();else if("setbackgrounddark"==e.msg)backgrounddark=e.value,removestylecode(),addstylecode();else if("setbackgroundcolor"==e.msg)1==e.value?removebackgroundpaper():addbackgroundpaper();else if("setbackgroundsource"==e.msg)backgroundsource=e.value,updatebackgroundpaper();else if("setbackgroundsize"==e.msg){var t=document.getElementById("bcknotepaper");t&&(t.style.backgroundSize=e.value+"px")}else"setprint"==e.msg&&(1==e.value?document.getElementById("printtext").className="btn-print":document.getElementById("printtext").className="hidden")}));